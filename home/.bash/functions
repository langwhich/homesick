function rbenv-update {
  if [ -d $HOME/.rbbld ]; then
    pushd $HOME/.rbbld > /dev/null
    git-up
    popd > /dev/null
  else
    git clone git://github.com/sstephenson/ruby-build.git $HOME/.rbbld
  fi

  if [ -d $HOME/.rbenv ]; then
    pushd $HOME/.rbenv > /dev/null
    git-up 
    popd > /dev/null
  else
    git clone git://github.com/sstephenson/rbenv.git $HOME/.rbenv
  fi

  local PLUGINS=(
    "sstephenson:rbenv-vars"
    "jamis:rbenv-gemset"
    "chriseppstein:rbenv-each"
    "carsomyr:rbenv-bundler"
  )

  for PLUGIN in ${PLUGINS[@]}; do
    local PLUGUSER=${PLUGIN%%:*}
    local PLUGNAME=${PLUGIN#*:}

    local PLUGROOT=$HOME/.rbenv/plugins/$PLUGNAME

    if [ -d $PLUGROOT ]; then
      pushd $PLUGROOT > /dev/null
      git-up
      popd > /dev/null
    else
      git clone git://github.com/$PLUGUSER/$PLUGNAME.git $PLUGROOT
    fi
  done
}
